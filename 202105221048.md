tags: #htb #nmap #enumeration
links: [[index]]

---

# nmap 
## cheat sheet
### Target Specification
| Switch    | Example                          | Description           |
| --------- | -------------------------------- | --------------------- |
|           | nmap 192.168.1.1                 | scan a single IP      |
|           | nmap 192.168.1.1 192.168.2.1     | scan 2 IP             |
|           | nmap 192.168.1.1 - 192.168.1.200 | scan a range          |
|           | nmap scanme.nmap.org             | scan a domain         |
|           | nmap 192.168.1.0/24              | scan using CIDR       |
| -iL       | nmap -iL targets.txt             | scan file targets     |
| -iR       | nmap -iR 100                     | scan 100 random hosts |
| --exclude | nmap --exclude 192.168.1.1       | exclude listed        |
|           |                                  |                       |
 
 ### Scan Techniques
 | Switch | Example         | Descripion                                |
 | ------ | --------------- | ----------------------------------------- |
 | -sS    | nmap \<ip\> -sS | SCP SYN port scan (default)               |
 | -sT    | nmap \<ip\> -sT | TCP connect port scan (default with root) |
 | -sU    | nmap \<ip\> -sU | UDP port scan                             |
 | -sA    | nmap \<ip\> -sA | TCP ACK Scan                              |
 | -sW    | nmap \<ip\> -sW | TCP windows port scan                     |
 | -sM    | nmap \<ip\> -sM | SCP Maimon port scan                      |

### Host Discovery
| Switch | Example                         | Description                             |
| ------ | ------------------------------- | --------------------------------------- |
| -sL    | nmap 192.168.1.1-3 -sL          | No Scan List targets only               |
| -sn    | nmap 192.168.1.1/24 -sn         | disable port scan. host disco only      |
| -Pn    | nmap 192.168.1.1-5 -Pn          | Disable host disco, port scan only      |
| -PS    | nmap 192.168.1.1-5 -PS 22-25,80 | TCP SYN disco on port x. p80 by default |
| -PA    | nmap 192.168.1.1-5 -PA 22-25,80 | TCP ACK "    "                          |
| -PU    | nmap 192.168.1.1-5 -PU 53       | UDP dico on port x. p40125 by default   |
| -PR    | nmap 192.168.1.1-1/24 -PR       | ARP disco on local net                  |
| -n     | nmap 192.168.1.1 -n             | never do DNS res                                        |

### Port Specification
| Switch | Example                             | Description                      |
| ------ | ----------------------------------- | -------------------------------- |
| -p     | nmap 192.168.1.1 -p 21              | port scan for port x             |
| -p     | nmap 192.168.1.1 -p 20-100          | port scan range                  |
| -p     | nmap 192.168.1.1 -p U:53,T:21-25,80 | Scan TCP and UDP as spec         |
| -p-    | nmap 192.168.1.1 -p-                | Scan all ports ==takes forever== |
| -p     | nmap 192.168.1.1 -p http.https      | port scan from service name      |
|        |                                     |                                  |
